<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>AI Note-Taker</title>
  <link rel="stylesheet" href="sidebar.css">
</head>
<body class="bg-gray-50 font-sans text-gray-900 h-screen overflow-hidden">

  <div id="sidebar-container" class="flex flex-col h-full">

    <!-- Header -->
    <div class="header bg-white border-b border-gray-200 p-4 flex items-center justify-between">
      <div class="flex items-center space-x-3">
        <div class="w-8 h-8 bg-indigo-600 rounded-lg flex items-center justify-center">
          <svg class="w-5 h-5 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"></path>
          </svg>
        </div>
        <div>
          <h1 class="text-lg font-semibold text-gray-900">AI Notes</h1>
          <p class="text-xs text-gray-500" id="notes-count">0 notes saved</p>
        </div>
      </div>
      <button id="close-sidebar" class="p-2 hover:bg-gray-100 rounded-lg transition-colors">
        <svg class="w-5 h-5 text-gray-500" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>
        </svg>
      </button>
    </div>

    <!-- AI Summary Section -->
    <div class="ai-summary-section bg-gradient-to-r from-indigo-50 to-purple-50 border-b border-gray-200 p-4">
      <div class="flex items-center justify-between mb-3">
        <button id="toggle-summary-section" class="flex items-center space-x-2 text-sm font-semibold text-gray-800 hover:text-indigo-600 transition-colors">
          <svg id="summary-chevron" class="w-4 h-4 transform transition-transform" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"></path>
          </svg>
          <span>Overall AI Summary</span>
        </button>
        <div class="flex items-center space-x-2">
          <button id="regenerate-summary" class="hidden bg-gray-100 hover:bg-gray-200 text-gray-700 text-xs px-2 py-1 rounded transition-colors">
            ðŸ”„ Regenerate
          </button>
          <button id="generate-overall-summary" class="bg-indigo-600 hover:bg-indigo-700 text-white text-xs px-3 py-1.5 rounded-lg transition-colors flex items-center space-x-1">
            <svg class="w-3 h-3" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 10V3L4 14h7v7l9-11h-7z"></path>
            </svg>
            <span>Generate Summary</span>
          </button>
        </div>
      </div>
      
      <div id="summary-section-content" class="summary-collapsible">
        <!-- Summary Loading State -->
        <div id="summary-loading" class="hidden">
          <div class="flex items-center space-x-2 text-sm text-gray-600">
            <div class="animate-spin rounded-full h-4 w-4 border-b-2 border-indigo-600"></div>
            <span>Generating AI summary...</span>
          </div>
        </div>
        
        <!-- Summary Content -->
        <div id="summary-content" class="hidden">
          <div class="bg-white rounded-lg p-3 border border-indigo-200">
            <div class="flex items-center justify-between mb-2">
              <span class="text-xs text-indigo-600 font-medium">âœ¨ AI Generated Summary</span>
              <span class="text-xs text-green-600 bg-green-50 px-2 py-1 rounded-full">âœ“ Complete</span>
            </div>
            <div id="summary-text" class="text-sm text-gray-700"></div>
          </div>
        </div>
        
        <!-- No Summary State -->
        <div id="no-summary" class="text-xs text-gray-500 italic">
          Generate an AI summary of all your notes to get key insights and themes.
        </div>
      </div>
    </div>


    <!-- Notes List -->
    <main id="notes-list" class="flex-1 overflow-y-auto p-4 space-y-3">
      <!-- Loading State -->
      <div id="loading-state" class="hidden text-center py-8">
        <div class="animate-spin rounded-full h-8 w-8 border-b-2 border-indigo-600 mx-auto"></div>
        <p class="text-sm text-gray-500 mt-2">Loading notes...</p>
      </div>

      <!-- Empty State -->
      <div id="empty-state" class="text-center py-12">
        <div class="w-16 h-16 bg-gray-100 rounded-full flex items-center justify-center mx-auto mb-4">
          <svg class="w-8 h-8 text-gray-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"></path>
          </svg>
        </div>
        <h3 class="text-lg font-medium text-gray-900 mb-2">No notes yet</h3>
        <p class="text-sm text-gray-500 mb-4">Highlight text on any webpage to create your first AI-powered note.</p>
        <div class="text-xs text-gray-400 bg-gray-50 rounded-lg p-3 max-w-xs mx-auto">
          <p class="font-medium mb-1">ðŸ’¡ Quick tip:</p>
          <p>Use <kbd class="px-1 py-0.5 bg-white border border-gray-200 rounded text-xs">Ctrl+Shift+N</kbd> to toggle this sidebar</p>
        </div>
      </div>

      <!-- Notes will be dynamically inserted here -->
    </main>

    <!-- Footer Actions -->
    <footer class="p-4 bg-white border-t border-gray-200">
      <div class="flex flex-col space-y-2">
        <!-- Export Options -->
        <div class="flex space-x-2">
          <button id="export-markdown" class="flex-1 py-2 px-3 text-sm font-medium rounded-md bg-indigo-600 text-white hover:bg-indigo-700 transition-colors flex items-center justify-center space-x-1">
            <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 10v6m0 0l-3-3m3 3l3-3m2 8H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"></path>
            </svg>
            <span>Export</span>
          </button>
          <button id="clear-all-btn" class="py-2 px-3 text-sm font-medium rounded-md bg-red-50 text-red-700 hover:bg-red-100 transition-colors flex items-center justify-center">
            <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"></path>
            </svg>
          </button>
        </div>
        
        <!-- API Status -->
        <div id="api-status" class="text-xs text-center py-1">
          <span class="text-gray-400">Powered by Gemini AI</span>
        </div>
      </div>
    </footer>

  </div>

  <!-- Note Card Template -->
  <template id="note-card-template">
    <div class="note-card bg-white rounded-lg shadow-sm border border-gray-200 p-4 hover:shadow-md transition-shadow">
      <!-- Note Header -->
      <div class="flex items-start justify-between mb-3">
        <div class="flex-1">
          <div class="flex items-center space-x-2 mb-1">
            <span class="note-date text-xs text-gray-500"></span>
            <span class="note-time text-xs text-gray-400"></span>
          </div>
          <h3 class="summary-title text-sm font-semibold text-gray-900 leading-tight"></h3>
        </div>
        <div class="flex items-center space-x-1 ml-2">
          <button class="copy-note-btn p-1 hover:bg-gray-100 rounded transition-colors" title="Copy note">
            <svg class="w-4 h-4 text-gray-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z"></path>
            </svg>
          </button>
          <button class="delete-note-btn p-1 hover:bg-red-50 hover:text-red-600 rounded transition-colors" title="Delete note">
            <svg class="w-4 h-4 text-gray-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"></path>
            </svg>
          </button>
        </div>
      </div>

      <!-- Note content only - no individual AI summary -->

      <!-- Original Text (Always Visible) -->
      <div class="original-text-section">
        <div class="original-text">
          <div class="bg-gray-50 border-l-3 border-indigo-200 p-3 rounded-r-md">
            <p class="text-sm text-gray-600 italic original-text-content"></p>
          </div>
        </div>
      </div>

      <!-- Citation -->
      <div class="citation-section mt-3 pt-3 border-t border-gray-100">
        <a href="#" target="_blank" class="citation-link text-xs text-indigo-600 hover:text-indigo-800 hover:underline flex items-center space-x-1 truncate">
          <svg class="w-3 h-3 flex-shrink-0" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 6H6a2 2 0 00-2 2v10a2 2 0 002 2h10a2 2 0 002-2v-4M14 4h6m0 0v6m0-6L10 14"></path>
          </svg>
          <span class="citation-text truncate"></span>
        </a>
      </div>
    </div>
  </template>

  <!-- Export Modal -->
  <div id="export-modal" class="hidden fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50">
    <div class="bg-white rounded-lg p-6 w-80 max-w-sm mx-4">
      <h3 class="text-lg font-semibold mb-4">Export Notes</h3>
      <div class="space-y-3">
        <button class="export-option w-full text-left p-3 border border-gray-200 rounded-lg hover:bg-gray-50 transition-colors" data-format="markdown">
          <div class="font-medium">Markdown (.md)</div>
          <div class="text-sm text-gray-500">Perfect for documentation</div>
        </button>
        <button class="export-option w-full text-left p-3 border border-gray-200 rounded-lg hover:bg-gray-50 transition-colors" data-format="txt">
          <div class="font-medium">Plain Text (.txt)</div>
          <div class="text-sm text-gray-500">Simple text format</div>
        </button>
        <button class="export-option w-full text-left p-3 border border-gray-200 rounded-lg hover:bg-gray-50 transition-colors" data-format="json">
          <div class="font-medium">JSON (.json)</div>
          <div class="text-sm text-gray-500">Structured data format</div>
        </button>
      </div>
      <div class="flex space-x-2 mt-6">
        <button id="cancel-export" class="flex-1 py-2 px-4 text-sm border border-gray-300 rounded-md hover:bg-gray-50 transition-colors">Cancel</button>
      </div>
    </div>
  </div>

  <script src="sidebar.js"></script>
</body>
</html>
